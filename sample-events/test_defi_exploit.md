# DeFi Protocol Flash Loan Exploit

## Event Summary
On 2026-02-10, a suspected flash loan attack was detected targeting the LendX Protocol on HashKey Chain. Approximately $2.3M in liquidity was drained from the USDT/HSK lending pool within a single transaction block.

## Key Evidence

### Transaction Analysis
- **Tx Hash**: `0xabc123...def456`
- **Block**: #8,234,567
- **Gas Used**: 4,200,000
- **Attacker Address**: `0x7a3F...9e2B`

### Attack Vector
1. Attacker borrowed 500,000 USDT via flash loan from Pool A
2. Deposited into LendX as collateral
3. Exploited price oracle manipulation to borrow 2x collateral value
4. Repaid flash loan, kept the difference

### Price Oracle Issue
The protocol relied on a single DEX TWAP oracle with a 5-minute window, which was insufficient to prevent manipulation during low-liquidity periods.

```solidity
// Vulnerable oracle code
function getPrice(address token) external view returns (uint256) {
    return IUniswapV2Pair(pair).price0CumulativeLast() / timeElapsed;
}
```

## Impact Assessment
- **Direct Loss**: ~$2.3M USDT equivalent
- **Affected Users**: 847 depositors
- **Protocol TVL Drop**: 68% within 24 hours

## Recommended Mitigations
- Implement Chainlink price feeds as primary oracle
- Add flash loan guards (same-block borrow/repay detection)
- Set maximum borrow ratio with time-lock for large positions
- Deploy circuit breaker for abnormal price movements > 10%

## Risk Rating
**CRITICAL** - Immediate action required

## References
- [LendX Audit Report (2025)](https://example.com/audit)
- [Flash Loan Attack Taxonomy](https://example.com/taxonomy)
